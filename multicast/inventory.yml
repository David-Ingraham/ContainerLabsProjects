all:
  vars:
    # Lab-level configuration
    lab_name: srlinux-multicast-lab
    
    # SR Linux API settings
    srlinux_jsonrpc_port: 80
    srlinux_gnmi_port: 57400
    
  children:
    routers:
      vars:
        # SR Linux connection settings for Ansible
        ansible_network_os: nokia.srlinux.srlinux
        ansible_connection: ansible.netcommon.httpapi
        ansible_httpapi_use_ssl: false
        ansible_httpapi_port: 80
        ansible_httpapi_validate_certs: false
        # Credentials loaded from credentials.yml via vars_files
        
      hosts:
        srl1:
          ansible_host: 172.20.0.11
          role: core
          router_id: 1.1.1.1
          bgp_as: 65001
          
          # Interfaces configuration
          interfaces:
            - name: ethernet-1/1
              description: "to srl2"
              ipv4: 10.0.12.1/30
              peer: srl2
              
            - name: ethernet-1/2
              description: "to srl3"
              ipv4: 10.0.13.1/30
              peer: srl3
              
            - name: ethernet-1/10
              description: "to source host"
              ipv4: 10.11.0.1/24
              
          # BGP neighbors
          bgp_neighbors:
            - address: 10.0.12.2
              peer_as: 65002
              description: "srl2"
            - address: 10.0.13.2
              peer_as: 65003
              description: "srl3"

        srl2:
          ansible_host: 172.20.0.12
          role: core
          router_id: 2.2.2.2
          bgp_as: 65002
          
          interfaces:
            - name: ethernet-1/1
              description: "to srl1"
              ipv4: 10.0.12.2/30
              peer: srl1
              
            - name: ethernet-1/2
              description: "to srl3"
              ipv4: 10.0.23.1/30
              peer: srl3
              
            - name: ethernet-1/10
              description: "to receiver1"
              ipv4: 10.12.0.1/24
              
          bgp_neighbors:
            - address: 10.0.12.1
              peer_as: 65001
              description: "srl1"
            - address: 10.0.23.2
              peer_as: 65003
              description: "srl3"

        srl3:
          ansible_host: 172.20.0.13
          role: core
          router_id: 3.3.3.3
          bgp_as: 65003
          
          interfaces:
            - name: ethernet-1/1
              description: "to srl2"
              ipv4: 10.0.23.2/30
              peer: srl2
              
            - name: ethernet-1/2
              description: "to srl1"
              ipv4: 10.0.13.2/30
              peer: srl1
              
            - name: ethernet-1/10
              description: "to receiver2"
              ipv4: 10.13.0.1/24
              
          bgp_neighbors:
            - address: 10.0.23.1
              peer_as: 65002
              description: "srl2"
            - address: 10.0.13.1
              peer_as: 65001
              description: "srl1"

    hosts:
      hosts:
        source:
          ansible_host: 172.20.0.20
          role: multicast_source
          data_plane_ip: 10.11.0.10
          gateway: 10.11.0.1
          connected_router: srl1
          
        receiver1:
          ansible_host: 172.20.0.21
          role: multicast_receiver
          data_plane_ip: 10.12.0.10
          gateway: 10.12.0.1
          connected_router: srl2
          
        receiver2:
          ansible_host: 172.20.0.22
          role: multicast_receiver
          data_plane_ip: 10.13.0.10
          gateway: 10.13.0.1
          connected_router: srl3

    # Links for create_links.py to configure
    # Format: docker networks connecting hosts to routers
    # Using 10.11-13.x subnets to avoid overlap with ansible-bgp-containerlab (10.1-2.x)
    link_definitions:
      vars:
        links:
          - name: source-net
            subnet: 10.11.0.0/24
            connections:
              - container: srl1
                ip: 10.11.0.1
              - container: source
                ip: 10.11.0.10
                gateway: 10.11.0.1
                
          - name: receiver1-net
            subnet: 10.12.0.0/24
            connections:
              - container: srl2
                ip: 10.12.0.1
              - container: receiver1
                ip: 10.12.0.10
                gateway: 10.12.0.1
                
          - name: receiver2-net
            subnet: 10.13.0.0/24
            connections:
              - container: srl3
                ip: 10.13.0.1
              - container: receiver2
                ip: 10.13.0.10
                gateway: 10.13.0.1

